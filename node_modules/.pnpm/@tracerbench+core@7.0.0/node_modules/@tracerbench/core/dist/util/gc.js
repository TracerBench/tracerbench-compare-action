"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const v8_1 = require("v8");
const vm_1 = require("vm");
const debug = require("debug");
const debugCallback = debug('tracerbench:gc');
// avoid v8 doing work while we are idling waiting for the sample to complete
['--predictable', '--single-threaded', '--single-threaded-gc'].forEach((flag) => {
    try {
        (0, v8_1.setFlagsFromString)(flag);
    }
    catch (e) {
        debugCallback('error setting flag %o', e);
    }
});
(0, v8_1.setFlagsFromString)('--expose-gc');
const _gc = (0, vm_1.runInNewContext)('gc');
function gc() {
    debugCallback('full gc');
    _gc();
}
exports.default = gc;
//# sourceMappingURL=gc.js.map